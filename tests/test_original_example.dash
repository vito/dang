# Test the original failing example

pub withAlpine(branch: String!): String! {
  pub self = {{ config: {{ contents: {{ packages: ["base"], repositories: ["base-repo"] }} }} }}
  
  # This should be able to access 'branch' parameter inside nested reopening
  self << {
    config << {
      contents << {
        packages += ["apk-tools"]
        repositories += [("https://dl-cdn.alpinelinux.org/alpine/" + branch) + "/main"]
      }
    }
  }
  
  # Return a simple result to verify it worked  
  "test passed"
}

pub result = withAlpine(branch: "edge")
assert { result == "test passed" }

print("Original example test passed!")